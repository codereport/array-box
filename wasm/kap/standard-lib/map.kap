namespace("map")

∇ (m) appendTo (values) {
  (2=≢⍴values and 2=↑↓⍴values) or (1=≢⍴values and 0=2|≢values) or 'kap:InvalidDimensionsException int:throwNative "Right argument to map should be either a rank-1 array with an even element count or a rank-2 array with 2 columns"
  pairs ← ¯1 2 ⍴ values
  m map:with pairs ({ (↑⍺) ⍮ (⊃(null≡⍵) ⊇ (⊃⍵) ⍬),⊂↑↓⍺ }⍤1 0) m map:get ,null 1 ↑ pairs
}

declare(:export map:appendTo)
